\doxysection{Value.\+hpp}
\hypertarget{_value_8hpp_source}{}\label{_value_8hpp_source}\index{include/Value.hpp@{include/Value.hpp}}
\mbox{\hyperlink{_value_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ <cstdio>}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ <unordered\_set>}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ <set>}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ <functional>}\ \textcolor{comment}{//\ std::function}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ <iomanip>}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{comment}{//\ m++\ headers}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_autograd_8hpp}{Autograd.hpp}}"{}}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{namespace\ }microgradpp\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{class\ }Value;}
\DoxyCodeLine{00052\ \ \ \ \ Autograd\ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}};}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structmicrogradpp_1_1_hash}{Hash}}\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structmicrogradpp_1_1_hash_a53a255959fc326b7c7e7a2fc62363a51}{operator()}}(\textcolor{keyword}{const}\ std::shared\_ptr<Value>\&\ value)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00064\ \ \ \ \ \};}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{using\ }ValuePtr\ =\ std::shared\_ptr<Value>;}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmicrogradpp_1_1_value}{Value}}\ :\ \textcolor{keyword}{public}\ std::enable\_shared\_from\_this<Value>\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classmicrogradpp_1_1_value}{Value}}(\textcolor{keywordtype}{float}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}},\ std::string\ \mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}},\ \textcolor{keywordtype}{size\_t}\ \textcolor{keywordtype}{id})}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}}(\mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}}),\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a11873b14bc740ec54a477af2e477ad65}{grad}}(0.0),\ \mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}}(std::move(\mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}})),\ \mbox{\hyperlink{classmicrogradpp_1_1_value_ac5c8389df7e79dc161e49bd12243ddcf}{id}}(\textcolor{keywordtype}{id})\ \{\}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ gradientFlag\ =\ \textcolor{keyword}{true};\ \ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a853a60f9c5e56d64681b2ab9bcc9cf75}{currentID}}\ =\ 0;\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}}\ =\ 0;\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a11873b14bc740ec54a477af2e477ad65}{grad}}\ =\ 0;\ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}};\ }
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \textcolor{keywordtype}{id}\ =\ 0LU;\ }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ std::vector<ValuePtr>\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a473db9d383baa5187aa41b1a40965f5a}{prev}};\ }
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ std::function<void()>\ \mbox{\hyperlink{classmicrogradpp_1_1_value_af6d1dc988cc64ebabde870ce593513b0}{backward}}\ =\ \textcolor{keyword}{nullptr};\ }
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_adfa24eb862aefa0e1c605bfa36444866}{generateID}}()\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ++\mbox{\hyperlink{classmicrogradpp_1_1_value_a853a60f9c5e56d64681b2ab9bcc9cf75}{currentID}};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}(\textcolor{keywordtype}{float}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}},\ std::string\ \mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}}\ =\ \textcolor{stringliteral}{"{}"{}})\{}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::shared\_ptr<Value>(\textcolor{keyword}{new}\ \mbox{\hyperlink{classmicrogradpp_1_1_value}{Value}}(\mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}},\ \ std::move(\mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}}),\ \mbox{\hyperlink{classmicrogradpp_1_1_value_adfa24eb862aefa0e1c605bfa36444866}{generateID}}()));}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_value_a747e83fde648505d0b8ee41bc0b894c2}{\string~Value}}()\{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/\mbox{\hyperlink{classmicrogradpp_1_1_value_a853a60f9c5e56d64681b2ab9bcc9cf75}{currentID}};}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a567fdbd8d0a17bf5c181057534b1e6a3}{label}};\ }
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a3dcf69644503a6b81ca9a6f7421453cd}{labelIdx}}\ =\ 0;\ }
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a48ac576db942bc4922ed4f4280649e06}{GRADIENT\_CLIP\_VALUE}}\ =\ 1e4;\ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a37d739936e16efe9bca307ba95c32974}{EPSILON}}\ =\ 1e-\/7;\ }
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a027e463ef87aebbc9e1f4d2e57f29b99}{setGradientFlag}}()\{}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a8778daa86bda466160990a558c838b38}{clip\_gradients}}()\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmicrogradpp_1_1_value_a11873b14bc740ec54a477af2e477ad65}{grad}}\ >\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a48ac576db942bc4922ed4f4280649e06}{GRADIENT\_CLIP\_VALUE}})\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a11873b14bc740ec54a477af2e477ad65}{grad}}\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a48ac576db942bc4922ed4f4280649e06}{GRADIENT\_CLIP\_VALUE}};}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classmicrogradpp_1_1_value_a11873b14bc740ec54a477af2e477ad65}{grad}}\ <\ -\/\mbox{\hyperlink{classmicrogradpp_1_1_value_a48ac576db942bc4922ed4f4280649e06}{GRADIENT\_CLIP\_VALUE}})\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a11873b14bc740ec54a477af2e477ad65}{grad}}\ =\ -\/\mbox{\hyperlink{classmicrogradpp_1_1_value_a48ac576db942bc4922ed4f4280649e06}{GRADIENT\_CLIP\_VALUE}};}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a8847e97acc9e0a418783c9020aac500e}{reset}}()\{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>grad\ =\ 0.0;}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>data\ =\ 0.0;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>prev.clear();}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a546daac3f29b9be620d8d6f7b56cf3fc}{resetGradients}}()\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_value_a11873b14bc740ec54a477af2e477ad65}{grad}}\ =\ 0;}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Addition}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a8e0413c6126c5024829b952489aa7e5c}{add}}(\textcolor{keyword}{const}\ ValuePtr\&\ lhs,\ \textcolor{keyword}{const}\ ValuePtr\&\ rhs)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}((\textcolor{keywordtype}{float})(lhs-\/>data\ +\ rhs-\/>data),\ \textcolor{stringliteral}{"{}+"{}});}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{lhs,\ rhs\};}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,\ [lhs\_weak\ =\ std::weak\_ptr<Value>(lhs),\ rhs\_weak\ =\ std::weak\_ptr<Value>(rhs),\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ lhs\ =\ lhs\_weak.lock())\ \{}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_weak.lock()-\/>grad\ +=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ rhs\ =\ rhs\_weak.lock())\ \{}}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_weak.lock()-\/>grad\ +=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_acd38f98da51632dadf944930d7e4dc15}{add}}(\textcolor{keyword}{const}\ ValuePtr\&\ lhs,\ \textcolor{keywordtype}{float}\ f)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rhs\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{Value::create}}((\textcolor{keywordtype}{float})f);}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}((\textcolor{keywordtype}{float})(lhs-\/>data\ +\ f),\ \textcolor{stringliteral}{"{}+"{}});}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{lhs,\ rhs\};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,\ [lhs\_weak\ =\ std::weak\_ptr<Value>(lhs),\ rhs\_weak\ =\ std::weak\_ptr<Value>(rhs),\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ lhs\ =\ lhs\_weak.lock())\ \{}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_weak.lock()-\/>grad\ +=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ rhs\ =\ rhs\_weak.lock())\ \{}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_weak.lock()-\/>grad\ +=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Multiplication}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_ab404a0dc56e44379e6da5c78389ec178}{multiply}}(\textcolor{keyword}{const}\ ValuePtr\&\ lhs,\ \textcolor{keyword}{const}\ ValuePtr\&\ rhs)\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}((\textcolor{keywordtype}{float})(lhs-\/>data\ *\ rhs-\/>data),\ \textcolor{stringliteral}{"{}*"{}});}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{lhs,\ rhs\};}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[lhs\_weak\ =\ std::weak\_ptr<Value>(lhs),\ rhs\_weak\ =\ std::weak\_ptr<Value>(rhs),\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ lhs\ =\ lhs\_weak.lock())\ \{}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_weak.lock()-\/>grad\ +=\ rhs\_weak.lock()-\/>data\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ rhs\ =\ rhs\_weak.lock())\ \{}}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_weak.lock()-\/>grad\ +=\ lhs\_weak.lock()-\/>data\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a19f3bb4e18282f379b49427e0899fc81}{multiply}}(\textcolor{keyword}{const}\ ValuePtr\&\ lhs,\ \textcolor{keywordtype}{float}\ f)\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rhs\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}(f);}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}((\textcolor{keywordtype}{float})(lhs-\/>data\ *\ f),\ \textcolor{stringliteral}{"{}*"{}});}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{lhs,\ rhs\};}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[lhs\_weak\ =\ std::weak\_ptr<Value>(lhs),\ rhs\_weak\ =\ std::weak\_ptr<Value>(rhs),\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ lhs\ =\ lhs\_weak.lock())\ \{}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_weak.lock()-\/>grad\ +=\ rhs\_weak.lock()-\/>data\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ rhs\ =\ rhs\_weak.lock())\ \{}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_weak.lock()-\/>grad\ +=\ lhs\_weak.lock()-\/>data\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Power}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a711e9b9ec523b5ad17e10122dc8b3953}{pow}}(\textcolor{keyword}{const}\ ValuePtr\&\ base,\ \textcolor{keywordtype}{float}\ exponent)\ \{}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ newValue\ =\ std::pow(base-\/>data,\ exponent);}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}(newValue,\ \textcolor{stringliteral}{"{}\string^"{}});}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{base\};}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[base\_weak\ =\ std::weak\_ptr<Value>(base),\ out\_weak\ =\ std::weak\_ptr<Value>(out),\ exponent]()\ \{}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ base\ =\ base\_weak.lock())\ \{}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ base-\/>grad\ +=\ exponent\ *\ std::pow(base-\/>data,\ exponent\ -\/\ 1)\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Division}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a59325a24efd12a8bf62ef6c73b681b7a}{divide}}\ (\ \textcolor{keyword}{const}\ std::shared\_ptr<Value>\&\ lhs,\ \textcolor{keywordtype}{float}\ otherValue)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_ab404a0dc56e44379e6da5c78389ec178}{multiply}}(lhs\ ,\ std::pow(otherValue,\ -\/1.0f));}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a26d0214a05050a4cfb8569af2f28d883}{divide}}(\textcolor{keyword}{const}\ ValuePtr\&\ lhs,\ \textcolor{keyword}{const}\ ValuePtr\&\ rhs)\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ reciprocal\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a711e9b9ec523b5ad17e10122dc8b3953}{pow}}(rhs,\ -\/1);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_ab404a0dc56e44379e6da5c78389ec178}{multiply}}(lhs,\ reciprocal);}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Subtraction}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a91834dfeca032f1f99cbabc1ec4a273e}{subtract}}(\textcolor{keyword}{const}\ ValuePtr\&\ lhs,\ \textcolor{keyword}{const}\ ValuePtr\&\ rhs)\ \{}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}((\textcolor{keywordtype}{float})(lhs-\/>data\ -\/\ rhs-\/>data),\ \textcolor{stringliteral}{"{}-\/"{}});}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{lhs,\ rhs\};}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[lhs\_weak\ =\ std::weak\_ptr<Value>(lhs),\ rhs\_weak\ =\ std::weak\_ptr<Value>(rhs),\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ lhs\ =\ lhs\_weak.lock())\ \{}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_weak.lock()-\/>grad\ +=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ rhs\ =\ rhs\_weak.lock())\ \{}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_weak.lock()-\/>grad\ -\/=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a590213c259ebd4651e1237e6c3675458}{subtract}}(\textcolor{keyword}{const}\ ValuePtr\&\ lhs,\ \textcolor{keywordtype}{float}\ f)\ \{}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rhs\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}(f);}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}((\textcolor{keywordtype}{float})(lhs-\/>data\ -\/\ rhs-\/>data),\ \textcolor{stringliteral}{"{}-\/"{}});}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{lhs,\ rhs\};}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[lhs\_weak\ =\ std::weak\_ptr<Value>(lhs),\ rhs\_weak\ =\ std::weak\_ptr<Value>(rhs),\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ lhs\ =\ lhs\_weak.lock())\ \{}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lhs\_weak.lock()-\/>grad\ +=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ (auto\ rhs\ =\ rhs\_weak.lock())\ \{}}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhs\_weak.lock()-\/>grad\ -\/=\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Activation\ functions}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a07aef3c3d4ed3d39e05734dc6642d2c6}{tanh}}(\textcolor{keyword}{const}\ ValuePtr\&\ v)\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ x\ =\ v-\/>data;}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ t\ =\ (std::exp(2\ *\ x)\ -\/\ 1)\ /\ (std::exp(2\ *\ x)\ +\ 1);}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}(t,\ \textcolor{stringliteral}{"{}tanh"{}});}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{v\};}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[v\_weak\ =\ std::weak\_ptr<Value>(v),\ t,\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\_weak.lock()-\/>grad\ +=\ (1\ -\/\ t\ *\ t)\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a1d1b6b557b21badf8d81cfbc361d63b1}{relu}}(\textcolor{keyword}{const}\ ValuePtr\&\ v)\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ val\ =\ std::max(0.0f,\ v-\/>data);}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}(val,\ \textcolor{stringliteral}{"{}ReLU"{}});}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{v\};}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[v\_weak\ =\ std::weak\_ptr<Value>(v),\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (v\_weak.lock())\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\_weak.lock()-\/>grad\ +=\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}((out\_weak.lock()-\/>\mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}}\ >\ 0))\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ ValuePtr\ \mbox{\hyperlink{classmicrogradpp_1_1_value_ab37c547a08a48b4d825ceadbceecfe1c}{sigmoid}}(\textcolor{keyword}{const}\ ValuePtr\&\ v)\ \{}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ x\ =\ v-\/>data;}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ t\ =\ std::exp(x)\ /\ (1\ +\ std::exp(x));}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ out\ =\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a052fbe55c17739acae958c7255a7590b}{create}}(t,\ \textcolor{stringliteral}{"{}Sigmoid"{}});}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ out-\/>prev\ =\ \{v\};}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a3cae934e38cf8b41fa448f3c11834470}{add\_entry}}(out,[v\_weak\ =\ std::weak\_ptr<Value>(v),\ t,\ out\_weak\ =\ std::weak\_ptr<Value>(out)]()\ \{}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\_weak.lock()-\/>grad\ +=\ t\ *\ (1\ -\/\ t)\ *\ out\_weak.lock()-\/>grad;}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//v\_weak.lock()-\/>clip\_gradients();}}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Topological\ sort}}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \textcolor{comment}{//\ \ \ \ \ \ \ \ void\ buildTopo(std::shared\_ptr<Value>\ v,\ std::unordered\_set<std::shared\_ptr<Value>,\ Hash>\&\ visited,\ std::vector<std::shared\_ptr<Value>>\&\ topo)\ \{}}
\DoxyCodeLine{00414\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ if\ (visited.find(v)\ ==\ visited.end())\ \{}}
\DoxyCodeLine{00415\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ visited.insert(v);}}
\DoxyCodeLine{00416\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (const\ auto\&\ child\ :\ v-\/>prev)\ \{}}
\DoxyCodeLine{00417\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buildTopo(child,\ visited,\ topo);}}
\DoxyCodeLine{00418\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00419\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ topo.push\_back(v);}}
\DoxyCodeLine{00420\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00421\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Backpropagation\ algorithm}}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Backpropagation}}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ backProp()\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classmicrogradpp_1_1_value_aa8863b2e5674522161b95dd4100a6c79}{\_backward}}();}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_aa8863b2e5674522161b95dd4100a6c79}{\_backward}}()\ \{}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ grad\ =\ 1.0f;}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1_autograd_aa6943749445aa13815022036b389cecb}{Autograd::global\_tape}}.\mbox{\hyperlink{classmicrogradpp_1_1_autograd_a43151b89f84cd33131b592d218967772}{backward}}();}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \textcolor{comment}{//\ \ \ \ \ \ \ \ /**}}
\DoxyCodeLine{00439\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ *\ @brief\ Builds\ the\ topological\ order\ of\ the\ computational\ graph.}}
\DoxyCodeLine{00440\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ *\ @param\ v\ The\ input\ ValuePtr.}}
\DoxyCodeLine{00441\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ *\ @param\ visited\ A\ set\ to\ track\ visited\ nodes.}}
\DoxyCodeLine{00442\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ *\ @param\ topo\ The\ topologically\ sorted\ output\ values.}}
\DoxyCodeLine{00443\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00444\ \textcolor{comment}{//\ \ \ \ \ \ \ \ void\ buildTopo(const\ ValuePtr\&\ v,\ std::unordered\_set<ValuePtr>\&\ visited,\ std::vector<ValuePtr>\&\ topo)\ \{}}
\DoxyCodeLine{00445\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ if\ (visited.find(v)\ ==\ visited.end())\ \{}}
\DoxyCodeLine{00446\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ visited.insert(v);}}
\DoxyCodeLine{00447\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ for\ (const\ auto\&\ child\ :\ v-\/>prev)\ \{}}
\DoxyCodeLine{00448\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buildTopo(child,\ visited,\ topo);}}
\DoxyCodeLine{00449\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00450\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ topo.push\_back(v);}}
\DoxyCodeLine{00451\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00452\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a483b00259ef0d15c68d6d76a6b051326}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classmicrogradpp_1_1_value}{Value}}\&\ other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ std::ostream\ \&\ operator\ <<\ (std::ostream\ \&os,\ \textcolor{keyword}{const}\ std::shared\_ptr<Value>\ \&v)\{}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ os\ <<\ \textcolor{stringliteral}{"{}[data:\ "{}}\ <<\ std::setw(3)\ <<\ v-\/>data\ <<\ \textcolor{stringliteral}{"{},\ grad:\ "{}}\ <<\ std::setw(3)\ <<\ v-\/>grad\ <<\ \textcolor{stringliteral}{"{}]\ "{}};}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ os;}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00460\ \ \ \ \ \};}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structmicrogradpp_1_1_hash_a53a255959fc326b7c7e7a2fc62363a51}{Hash::operator()}}(\textcolor{keyword}{const}\ std::shared\_ptr<Value>\&\ value)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!value)\ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::hash<const\ void*>()(value.get());}
\DoxyCodeLine{00469\ \ \ \ \ \}}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a483b00259ef0d15c68d6d76a6b051326}{Value::operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classmicrogradpp_1_1_value}{Value}}\&\ other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}}\ ==\ other.\mbox{\hyperlink{classmicrogradpp_1_1_value_a0bbccc395e757d34afe68f0baf4396f6}{data}}\ \&\&\ \mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}}\ ==\ other.\mbox{\hyperlink{classmicrogradpp_1_1_value_aab6bc737d047c4410d73bb059a4654e0}{op}}\ \&\&\ \mbox{\hyperlink{classmicrogradpp_1_1_value_a473db9d383baa5187aa41b1a40965f5a}{prev}}\ ==\ other.\mbox{\hyperlink{classmicrogradpp_1_1_value_a473db9d383baa5187aa41b1a40965f5a}{prev}};}
\DoxyCodeLine{00473\ \ \ \ \ \}}
\DoxyCodeLine{00474\ \}}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ }

\end{DoxyCode}
