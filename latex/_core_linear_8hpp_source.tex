\doxysection{Core\+Linear.\+hpp}
\hypertarget{_core_linear_8hpp_source}{}\label{_core_linear_8hpp_source}\index{include/core/CoreLinear.hpp@{include/core/CoreLinear.hpp}}
\mbox{\hyperlink{_core_linear_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{comment}{//\ Standard\ libraries}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{comment}{//\ microgradpp\ libraries}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_mpp_core_8hpp}{MppCore.hpp}}"{}}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_neuron_8hpp}{Neuron.hpp}}"{}}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_value_8hpp}{Value.hpp}}"{}}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ "{}TypeDefs.hpp"{}}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{keyword}{namespace\ }microgradpp::core\ \{}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear}{CoreLinear}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classmicrogradpp_1_1core_1_1_mpp_core}{MppCore}}\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_nin;\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_nout;\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ std::vector<Neuron>\ \_neurons;\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear_a8da8e86c3c057ef224b2ef82b4ba8963}{CoreLinear}}(\textcolor{keywordtype}{size\_t}\ nin,\ \textcolor{keywordtype}{size\_t}\ nout):\ \_nin(nin),\ \_nout(nout)\{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t}\ idx\ =\ 0;\ idx\ <\ nout;\ ++idx)\{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\_neurons.emplace\_back(nin);}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1___tensor1_d}{Tensor1D}}\ \mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear_a8d341061512db3a8c25b1c8d3347f008}{operator()}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classmicrogradpp_1_1___tensor1_d}{Tensor1D}}\&\ x)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmicrogradpp_1_1___tensor1_d}{Tensor1D}}\ out;}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ out.\mbox{\hyperlink{classmicrogradpp_1_1_base_tensor_a70b58da89b5a848cb20aa4bbc2a26302}{reserve}}(this-\/>\_neurons.size());}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ std::for\_each(this-\/>\_neurons.begin(),\ this-\/>\_neurons.end(),\ [\&out,\ x=x](\ \ \ \textcolor{keyword}{auto}\ neuron)\textcolor{keyword}{mutable}\{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out.emplace\_back(neuron(x));}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out;}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear_ae14726dac6e95bb6dbd6fcad05b01c27}{print}}()\ const\ override\ final\{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \_nin\ <<\ \textcolor{stringliteral}{"{}\ X\ "{}}\ <<\ \_nout\ <<\ \textcolor{stringliteral}{"{}\ Linear\ Layer"{}}<<\ std::endl;}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear_af9b8ed09c652ae6e9a6f58c2566e33af}{zeroGrad}}()\ override\ final\{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}\&\ neuron:\ this-\/>\_neurons)\{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ neuron.zeroGrad();}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \_\_MICROGRADPP\_NO\_DISCARD\_\_}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ std::vector<Value*>\ \mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear_a55b33782c067afb9bdc7d0b747483937}{parameters}}()\textcolor{keyword}{\ const\ override}\{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<Value*>\ params;}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(params.empty())\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ neuron\ :\ \_neurons)\{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ p\ :\ neuron.parameters())\{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ params.push\_back(p.get());}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ params;}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear_a6dd5a2781e687cd7858dc38985ca1dd2}{printParameters}}()\textcolor{keyword}{\ const\ override}\{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ params\ =\ this-\/>\mbox{\hyperlink{classmicrogradpp_1_1core_1_1_core_linear_a55b33782c067afb9bdc7d0b747483937}{parameters}}();}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Num\ parameters:\ \%d\(\backslash\)n"{}},\ (\textcolor{keywordtype}{int})params.size());}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ p\ :\ params)\{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout<<\ \&p\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}[data=\%f,grad=\%lf]\(\backslash\)n"{}},\ p-\/>data,\ p-\/>grad);}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ \ \ \ \ \};}
\DoxyCodeLine{00133\ \ \ \ \ \};}
\DoxyCodeLine{00134\ \}}

\end{DoxyCode}
